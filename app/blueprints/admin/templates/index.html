{% extends "base.html" %}

{% block content %}
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Page</title>
    
    <!-- Link to external CSS -->
    <link rel="stylesheet" href="{{ url_for('admin.static', filename='styles.css') }}">
    </head>
    <h2>Admin Page</h2>

    <!-- Tab navigation -->
    <div class="tabs">
        <button class="tab-button" onclick="openTab(event, 'artists')">Artists</button>
        <button class="tab-button" onclick="openTab(event, 'exponats')">Exponats</button>
        <button class="tab-button" onclick="openTab(event, 'exhibition_rooms')">Exhibition Rooms</button>
        <button class="tab-button" onclick="openTab(event, 'institutions')">Partner Institutions</button>
    </div>

    <div id="success-message", class="success-message"></div>

    <!-- Artists tab -->
    <div id="artists" class="tab-content">
        <h1>Our Artists:</h1>
        <ul>
            {% for artist in artists %}
                <li>
                    {{artist.imie_nazwisko}} 
                    ({{artist.data_urodzenia if artist.data_urodzenia else "Unknown"}} - 
                    {{artist.data_smierci if artist.data_smierci else "Present" }})
                    
                    <!-- Edit button -->
                    <button onclick="editArtist({{artist|safe}})">Edit</button>
                </li>
            {% endfor %}
            <button onclick="displayAddModal('addArtistModal')">Add Artist</button>
        </ul>
    </div>


    <div id="exponats" class="tab-content" style="display: none;">
        <h1>Our Exponats:</h1>
        <ul>
            {% for exponat in exponats %}
                <li>
                    {{exponat.tytul}} 
                    <button onclick="editExponat({{exponat|safe}})">Edit</button>
                </li>
            {% endfor %}
            <button onclick="displayAddModal('addExponatModal')">Add Exponat</button>
        </ul>
    </div>

    <div id="exhibition_rooms" class="tab-content" style="display: none;">
        <h1>Our Exhibition Rooms:</h1>
        <ul>
            {% for room in exhibition_rooms %}
                <li>
                    {{room.nazwa_galerii}} 
                    <button onclick="editRoom({{room|safe}})">Edit</button>
                    <button onclick="openModal({{room.id}}, '{{room.nazwa_galerii}}')">Assign Exponat</button>
                </li>
            {% endfor %}
        </ul>
    </div>


    <div id="institutions" class="tab-content" style="display: none;">
        <h1>Our Partner Institutions:</h1>
        <ul>
            {% for institution in institutions %}
                <li>
                    {{institution.nazwa}} - {{institution.miasto}}
                </li>
            {% endfor %}
            <button onclick="displayAddModal('addInstitutionModal')">Add Institution</button>
        </ul>
    </div>

    <!-- edit artist modal -->
    <div id="editModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editModal')">&times;</span>
            <h2>Edit Artist</h2>
            <form id="editForm" onsubmit="saveChangesArtist(event)">
                <input type="hidden" id="artistId" name="id">
                <label for="imie_nazwisko">Name:</label>
                <input type="text" id="imie_nazwisko" name="imie_nazwisko" required>
                <label for="data_urodzenia">Birth Date:</label>
                <input type="date" id="data_urodzenia" name="data_urodzenia" required>
                <label for="data_smierci">Death Date:</label>
                <input type="date" id="data_smierci" name="data_smierci">
                <button type="submit">Save</button>
            </form>
        </div>
    </div>


    <div id="addArtistModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addArtistModal')">&times;</span>
            <h2>Add Artist</h2>
            <form id="addArtistForm" onsubmit="saveEntity(event,'addArtistForm', '/admin/save_new_artist', 'addArtistModal', 'POST')">
                <input type="hidden" id="artistId" name="id">
                <label for="imie_nazwisko">Name:</label>
                <input type="text" id="imie_nazwisko" name="imie_nazwisko" required>
                <label for="data_urodzenia">Birth Date:</label>
                <input type="date" id="data_urodzenia" name="data_urodzenia">
                <label for="data_smierci">Death Date:</label>
                <input type="date" id="data_smierci" name="data_smierci">
                <button type="submit">Save</button>
            </form>
        </div>
    </div>
    
    <div id="editRoomModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editRoomModal')">&times;</span>
            <h2>Edit Room</h2>
            <form id="editRoomForm" onsubmit="saveChangesRoom(event)">
                <input type="hidden" id="roomId" name="id">
                <label for="nazwa_galerii">Room Name:</label>
                <input type="text" id="nazwa_galerii" name="nazwa_galerii" required>

                <button type="submit">Save</button>
            </form>
        </div>
    </div>

    <div id="assignModal" class="assignModal">
        <h2 id="modal-title"></h2>
        <label for="exponat-select">Select an Exponat:</label>
        <select id="exponat-select"></select>
        <button onclick="assignExponat()">Assign</button>
        <button onclick="closeModal('assignModal')">Close</button>
    </div>

    <div id="addInstitutionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addInstitutionModal')">&times;</span>
            <h2>Add Institution</h2>
            <form id="addInstitutionForm" onsubmit="saveEntity(event,'addInstitutionForm', '/admin/save_new_institution', 'addInstitutionModal', 'POST')">
                <input type="hidden" id="artistId" name="id">
                <label for="nazwa">Name:</label>
                <input type="text" id="nazwa" name="nazwa" required>
                <label for="miasto">City:</label>
                <input type="text" id="miasto" name="miasto" required>
                <button type="submit">Save</button>
            </form>
        </div>
    </div>

    <div id="editExponatModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editExponatModal')">&times;</span>
            <h2>Edit Exponat</h2>
            <form id="editExponatForm" onsubmit="saveEntity(event, 'editExponatForm', '/admin/save_new_exponat', 'editExponatModal', 'PUT')">
                <input type="hidden" id="id" name="id">
                <label for="tytul">Title:</label>
                <input type="text" id="tytul" name="tytul" required>
                <label for="artysta_id">Artist ID:</label>
                <input type="number" id="artysta_id" name="artysta_id" required>
                <label for="wysokosc">Height (cm):</label>
                <input type="number" id="wysokosc" name="wysokosc" step="0.01" min="0.01" required>
                <label for="szerokosc">Width (cm):</label>
                <input type="number" id="szerokosc" name="szerokosc" step="0.01" min="0.01" required>
                <label for="waga">Weight (kg):</label>
                <input type="number" id="waga" name="waga" step="0.01" min="0.01" required>
                <button type="submit">Save</button>
            </form>
        </div>
    </div>
    


    <div id="addExponatModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addExponatModal')">&times;</span>
            <h2>Add Exponat</h2>
            <form id="addExponatForm" onsubmit="saveEntity(event, 'addExponatForm', '/admin/save_new_exponat', 'addExponatModal', 'POST')">
                <input type="hidden" id="id" name="id">
                <label for="tytul">Title:</label>
                <input type="text" id="tytul" name="tytul" required>
                <label for="artysta_id">Artist ID:</label>
                <input type="number" id="artysta_id" name="artysta_id" required>
                <label for="wysokosc">Height (cm):</label>
                <input type="number" id="wysokosc" name="wysokosc" step="0.01" min="0.01" required>
                <label for="szerokosc">Width (cm):</label>
                <input type="number" id="szerokosc" name="szerokosc" step="0.01" min="0.01" required>
                <label for="waga">Weight (kg):</label>
                <input type="number" id="waga" name="waga" step="0.01" min="0.01" required>
                <button type="submit">Save</button>
            </form>
        </div>
    </div>
    <script src="{{ url_for('admin.static', filename='scripts.js') }}"></script>
{% endblock %}
